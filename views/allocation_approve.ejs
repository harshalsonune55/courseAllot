<div class="p-12 bg-gray-100 min-h-screen">


    <div class="mb-10">
      <input
        type="text"
        placeholder="Search courses, faculty, allocations..."
        class="w-full border-2 border-gray-300 rounded-xl px-6 py-4 focus:ring-2 focus:ring-blue-600 focus:outline-none"
      />
    </div>
  
    <% const allReq = (requests || []); %>
    <% const pending = allReq.filter(r => r.status === "PENDING"); %>
  
 
    <div class="border-2 border-gray-300 rounded-2xl p-10 mb-14 bg-white">
  
      <h2 class="text-2xl font-semibold mb-3">
        Pending Allocation Requests ✨
      </h2>
  
      <p class="text-gray-600 mb-8">
        Review and approve/reject allocation requests from faculty.
      </p>
  
      <% if(pending.length === 0){ %>
        <p class="text-gray-500">No pending requests.</p>
      <% } %>
  
      <% pending.forEach(req => { %>
  
        <div class="bg-gray-50 rounded-2xl p-8 mb-8 shadow-sm">
  
      
          <div class="flex justify-between items-start mb-6">
  
            <div>
              <h3 class="text-xl font-semibold">
                <%= req.faculty?.fullName || "Unknown Faculty" %> → <%= req.courseName %>
              </h3>
  
              <div class="mt-3 space-y-1 text-sm text-gray-600">
                <p>
                  Department: <strong><%= req.faculty?.department || "Not Provided" %></strong>
                </p>
  
                <p>
                  Experience: <strong><%= req.faculty?.experienceYears || 0 %> years</strong>
                </p>
  
                <p>
                  Education: <strong><%= req.faculty?.education || "N/A" %></strong>
                </p>
  
                <p>
                  AI Match Score:
                  <span class="text-green-700 font-semibold">
                    <%= req.matchScore %>%
                  </span>
                </p>
                <p class="text-blue-800 font-semibold " >
                  <strong>Comment:</strong> 
                  <%= req.comment || "No comment provided" %>
                </p>
                <div class="mt-4">
                  <form action="/reject-with-comment/<%= req._id %>" method="POST">
                    
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                      Reply to Faculty (This will reject the request):
                    </label>
                
                    <textarea 
                      name="hodReply" 
                      rows="3"
                      placeholder="Write your feedback or reason for rejection..."
                      required
                      class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-red-600 focus:outline-none"
                    ></textarea>
                
                    <button
                      type="submit"
                      class="mt-3 bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition">
                      Submit Reply & Reject
                    </button>
                
                  </form>
                </div>
                
              </div>
  
              <p class="text-gray-400 text-sm mt-2">
                Requested:
                <% const when = req.requestedAt || req.createdAt; %>
                <%= when ? new Date(when).toLocaleString() : "N/A" %>
              </p>
            </div>
  
            <span class="bg-gray-900 text-white px-5 py-2 rounded-full text-sm">
              PENDING
            </span>
  
          </div>
  
        
          <div class="flex gap-6">
  
            <form action="/approve/<%= req._id %>" method="POST" class="flex-1">
              <button
                class="w-full bg-green-700 text-white py-4 rounded-xl text-lg font-medium hover:bg-green-800 transition">
                ✔ Approve
              </button>
            </form>
  
            <form action="/reject/<%= req._id %>" method="POST" class="flex-1">
              <button
                class="w-full bg-gray-600 text-white py-4 rounded-xl text-lg font-medium hover:bg-gray-700 transition">
                ✖ Reject
              </button>
            </form>
  
          </div>
  
        </div>
  
      <% }) %>
  
    </div>
  

    <div class="border-2 border-gray-300 rounded-2xl p-10 bg-white">
  
      <h2 class="text-2xl font-semibold mb-8">
        All Allocations
      </h2>
  
      <% if(allReq.length === 0){ %>
        <p class="text-gray-500">No allocations yet.</p>
      <% } %>
  
      <% allReq.forEach(req => { %>
  
        <div class="bg-gray-50 rounded-2xl p-8 mb-6 flex justify-between items-center shadow-sm">
  
          <div>
            <h3 class="text-xl font-semibold">
              <%= req.courseName %>
            </h3>
  
            <p class="text-gray-600 mt-1">
              <%= req.faculty?.fullName || "Unknown Faculty" %>
            </p>
            <p class="text-gray-600 mt-2">
              <strong>Comment:</strong> 
              <%= req.comment || "No comment provided" %>
            </p>
            
  
            <p class="text-green-700 mt-2">
              AI: <%= req.matchScore %>%
            </p>
          </div>
  
          <% if(req.status === "APPROVED"){ %>
            <span class="bg-green-700 text-white px-6 py-2 rounded-full text-sm">
              APPROVED
            </span>
          <% } else if(req.status === "REJECTED"){ %>
            <span class="bg-red-600 text-white px-6 py-2 rounded-full text-sm">
              REJECTED
            </span>
          <% } else { %>
            <span class="bg-gray-900 text-white px-6 py-2 rounded-full text-sm">
              PENDING
            </span>
          <% } %>
  
        </div>
  
      <% }) %>
  
    </div>
  
  </div>
  